 pthread t pthread self current thread id mg conn ssl mg connect conn conn conn ssl null sockaddr string buf size t len usa usa buf   \\ defin use ipv inet ntop usa sa sa famili usa sa sa famili af inet usa sin sin addr usa sin sin addr buf socklen t len elif defin win windoz vista newer inet ntop strncpi s buf max src addr inet ntoa usa sin sin addr len inet ntop usa sa sa famili usa sin sin addr buf len endif print error messag open error log stream mg connect conn fmt buf  mg buf len  src addr  max src addr  va list ap time t timestamp va start ap fmt vsnprintf buf buf fmt ap va end ap lock get callback valu suppos fine function disappear way string option conn request info ev data buf timestamp time null sockaddr string src addr src addr conn client rsa est log err ``  lu   error   client s  `` timestamp src addr conn request info request method null est log err `` s s `` conn request info request method conn request info uri est log err `` s buf conn request info ev data null applic moment log mg connect fc mg context ctx mg connect fake connect fake connect ctx ctx fake connect applic moment log mg version mongoos version applic moment log mg request info mg request info mg connect conn conn request info applic moment log mg strlcpi dst src size t n src \\ n n dst src dst \\ applic moment log mg strndup ptr size t len p p malloc len null mg strlcpi p ptr len p applic moment log lowercas s tolow s applic moment log mg strncasecmp s s size t len diff len diff lowercas s lowercas s diff s   \\ len diff applic moment log mg strcasecmp s s diff diff lowercas s lowercas s diff s   \\ diff audit report mg vsnprintf mg connect conn buf size t buflen fmt va list ap n buflen n vsnprintf buf buflen fmt ap n conn `` vsnprintf error n n buflen conn `` truncat vsnprintf buffer  s  n n buf n buflen buf  n  \\ n printf arg mg snprintf mg connect conn buf size t buflen fmt va list ap n va start ap fmt n mg vsnprintf conn buf buflen fmt ap va end ap n printf arg size t est strcspn str str rsize t count errno t safec rc str null str   \\ safec rc strcspn s str strnlen s str rsize max str str rsize max str count safec rc eok est log info `` strcspn s error x x o\\n safec rc count printf arg size t est strspn str str rsize t count errno t safec rc str null str   \\ safec rc strspn s str strnlen s str rsize max str str rsize max str count safec rc eok est log info `` strspn s error x x o\\n safec rc count delimit quot quotechar skip quot buf delimit whitespac quotechar p begin word end word end whitespac begin word buf end word begin word est strcspn begin word delimit check quotechar end word begin word p end word p quotechar end word copi end word \\ p \\ rsize t end rsize t est strcspn end word delimit memmov s p end end word end p end p correspond end word end word end p p end word p p \\ end word \\ buf end word end whitespac end word est strspn end word whitespac p end word p end whitespac p p \\ buf end whitespac begin word whitespac delimit skip buf delimit skip quot buf delimit delimit http header valu null header mg request info ri ri num header mg strcasecmp ri http header   ri http header   valu null http header valu null mg header mg connect conn header conn request info set exampl request pars fail aliv mg connect conn http version conn request info http version header mg header conn `` connect slight deviat mongoos behavior close connect send accept respons close connect xx respons mongoos close unauthor conn close conn status code est http stat_ conn status code conn ctx enabl keepal header null mg strcasecmp header `` aliv header null http version strncmp http version `` set exampl request pars fail suggest connect header mg connect conn aliv conn `` aliv `` close set exampl request pars fail mg send http error mg connect conn status reason fmt buf  mg buf len  va list ap len conn status code status conn request info ev data status buf   \\ len error xx send bodi status status status len mg snprintf conn buf buf `` error d s status reason buf  len  \\n va start ap fmt len mg vsnprintf conn buf len buf len fmt ap va end ap est log info ``  s  buf mg printf conn `` http d s\\r\\n `` content length d\\r\\n `` connect s\\r\\n\\r\\n status reason len suggest connect header conn conn num byte sent mg printf conn `` s buf window chang slash backslash path name chang slash backslash path path   \\ path   path   \\\\ check preserv unc path like \\\\server\\fil txt path   \\\\ path   \\\\ path   memmov s path est uri max len path strnlen s path est uri max len wbuf wbuf len target buffer length unicod path wchar t wbuf size t wbuf len buf  path max  buf  path max  p mg strlcpi buf path buf chang slash backslash buf point p end file p buf strnlen s buf est uri max len convert unicod doubli convert string doe match origin fishi reject memzero s wbuf wbuf len wchar t multi byte wide cp utf buf wbuf wbuf len wide multi byte cp utf wbuf wbuf len buf buf null null strcmp buf buf wbuf   l\\ function return non path end garbag path disclos cgi path allow charact `` _ path  strnlen s path est uri max len  isalnum strchr allow charact null function return non path end garbag handl dlopen dll flag wchar t wbuf  path max  flag unus unicod dll wbuf array size wbuf load librari w wbuf descriptor number byte written t push file fp socket sock ssl ssl buf t len t sent n k sent sent len byte send iter k len sent max max len sent ssl null n ssl write ssl buf sent k fp null n fwrite buf sent size t k fp ferror fp n n send sock buf sent size t k msg nosign n sent n sent read close connect exit serv thread wait socket readabl mg connect conn pollfd pfd result time est uint total wait time est uint read timeout conn read timeout accuml total time wait total wait time msec poll wait time pfd fd conn client sock pfd event pollin pfd revent errno result poll pfd msec poll wait time result conn ssl null result ssl pend conn ssl check s time set thing accord close session total wait time read timeout result time conn close result wait s read socket poll interrupt signal master process indic stop wait read timeout occur result result errno eintr conn ctx stop flag time conn ctx stop flag result negat valu error number byte read success pull file fp mg connect conn buf len nread err cd fp null use read instead fread read cgi pipe fread block io buffer fill afford block pass read byte immedi client nread read fileno fp buf size t len conn close wait socket readabl conn nread conn ssl null nread ssl read conn ssl buf len err cd ssl error conn ssl nread err cd ssl error s grace shutdown ssl error want read data come chang nread zero mongoos attempt read data peer occur peer initi ssl renegot nread ssl error want x lookup est log err `` ssl read error want lookup\\n error simpli log error make sure nread indic error function est log err `` ssl read error code d\\n err cd nread nread recv conn client sock buf size t len conn ctx stop flag nread negat valu error number byte read success mg read mg connect conn buf size t len n buffer len nread bodi rsize t max len nread max len rsize t len conn consum content conn content len adjust number byte read t read conn content len conn consum content read t len len size t read buffer data bodi conn buf conn request len conn consum content buffer len conn buf  conn data len  bodi buffer len len size t buffer len buffer len len memcpi s buf max len bodi rsize t buffer len len buffer len conn consum content buffer len nread buffer len buf buf buffer len return buffer data read new data remot socket len n pull null conn buf len n nread n propag error n buf buf n conn consum content n nread n len n n retri nread negat valu error number byte read success mg write mg connect conn buf size t len t total total push null conn client sock conn ssl buf t len total negat valu error number byte read success mg printf mg connect conn fmt mem  mg buf len  buf mem len va list ap print local buffer hope larg hold messag va start ap fmt len vsnprintf mem mem fmt ap va end ap len mg printf conn `` s `` call len vsnprintf error len conn `` s s vsnprintf error _ func__ fmt len mem buf malloc len null local buffer larg alloc big buffer heap va start ap fmt vsnprintf buf len fmt ap va end ap len mg write conn buf size t len free buf len mem fail alloc larg buffer conn `` s s ca nt alloc d byte print _ func__ fmt len len copi local buffer succeed len mg write conn buf size t len len http ftp ic uci edu pub ietf html rfc txt url decod src src len dst dst len form url encod j b defin hextoi x isdigit x x x w j src len j dst len j src   isxdigit src isxdigit src tolow src b tolow src dst  j  hextoi hextoi b form url encod src   dst  j  dst  j  src   dst  j  \\ null termin destin src len j actual request length includ \\r\\n\\r\\n request len buf buflen s e len s buf e s buflen len s e s control charact allow isprint s s \\r s \\n s len   abort scan soon malform charact nt let subsequ \\r\\n\\r\\n win s   \\n s   \\n len s buf s   \\n s   e s   \\r s   \\n len s buf len excess \\ charact remov dot slash s p s s \\ p s s   s   \\\\ skip follow slash backslash dot s   \\ s   s   \\\\ s s   s   s p \\ perform pars http authent header client basic authent use mg pars auth hdr basic mg connect conn auth header est http auth hdr ah valu s save ptr  max uidpwd  contain uid pwd rsize t len sep `` colon possibl pw s auth header gobbl initi space isspac s s valu s len est base decod valu max uidpwd len est log warn `` base decod http auth header fail http auth fail make sure s string colon strstr s len `` possibl pw colon eok est log warn `` invalid format basic http credenti miss memzero s max uidpwd did start colon mean userid   len just password possibl pw ah pwd strndup possibl pw max uidpwd est log info `` http authent header contain password got userid password est log info `` http authent header contain userid password memzero s max uidpwd start userid pars usernam password separ `` valu strtok s len sep save ptr valu ah user strndup valu max uidpwd ah pwd strndup save ptr max uidpwd ah mode auth basic memzero s max uidpwd perform pars http authent header client digest authent use mg pars auth hdr digest mg connect conn auth header est http auth hdr ah valu s buf  max auth hdr len  ah mode auth digest make modifi copi auth header strncpi s buf max auth hdr len auth header max auth hdr len s buf pars author header gobbl initi space isspac s s skip quot s `` `` `` valu quot delimit end comma space s   \\ s valu skip quot s `` \\ `` `` \\\\ s   s valu skip quot s `` `` `` `` use comma ff use space \\ memcmp s `` usernam ah user strndup valu max uidpwd memcmp s `` cnonc ah cnonc strndup valu max nonc memcmp s `` respons ah respons strndup valu max respons memcmp s `` uri ah uri strndup valu max realm memcmp s `` qop ah qop strndup valu max qop memcmp s `` nc ah nc strndup valu max nc memcmp s `` nonc ah nonc strndup valu max nonc perform pars http authent header client token bearer authent use mg pars auth hdr token mg connect conn auth header est http auth hdr ah valu s valu decod  max auth token len  len s auth header strlen est bearer token str gobbl initi space isspac s s valu s memzero s valu decod max auth token len len est base decod valu valu decod max auth token len len est log warn `` base decod http auth credenti fail http auth fail s \\ copi token auth header structur ah auth token strndup valu decod max auth token len ah mode auth token ah auth token null est log err `` fail obtain memori authent token buffer est log err `` authent header client contain token function pars http authent header client field est http auth hdr use later verifi user s credenti use http basic http digest authent ah paramet alloc call function good bad miss est http auth hdr result mg pars auth header mg connect conn est http auth hdr ah auth header auth header http client auth header mg header conn `` author null est auth hdr miss mg strncasecmp auth header `` digest `` make sure server configur digest auth conn ctx est ctx auth mode auth digest est auth hdr bad mg pars auth hdr digest conn auth header ah mg strncasecmp auth header `` basic `` make sure server configur basic auth conn ctx est ctx auth mode auth basic est auth hdr bad mg pars auth hdr basic conn auth header ah mg strncasecmp auth header est bearer token str strlen est bearer token str make sure server configur bearer token auth conn ctx est ctx auth mode auth token est auth hdr bad mg pars auth hdr token conn auth header ah basic digest bearer token authent support ah mode auth fail est auth hdr bad do digest auth make sure valu pars ah mode auth digest ah uri ah nonc ah nc ah cnonc est log err `` pars http auth header fail est auth hdr bad abl pars user id token auth mode make sure fail authent ah user null ah mode auth token est auth hdr bad ah mode auth token save user id connect context want pass ca later strncpi s conn user id mg uid max ah user mg uid max est auth hdr good function pars http authent header client field est http auth hdr use later verifi user s credenti use http basic http digest authent ah paramet alloc call function good bad miss mg send author request mg connect conn conn status code conn ctx est ctx auth mode auth basic mg printf conn `` s\\r\\n `` s \\r\\n `` s basic realm\\ s\\ \\r\\n\\r\\n est http hdr_ est http hdr cl est http hdr auth conn ctx est ctx realm auth digest mg printf conn `` s\\r\\n `` s \\r\\n `` s digest qop\\ auth\\ `` `` realm\\ s\\ nonce\\ lu\\ \\r\\n\\r\\n est http hdr_ est http hdr cl est http hdr auth conn ctx est ctx realm time null auth token mg printf conn `` s\\r\\n `` s \\r\\n `` s bearer realm\\ s\\ \\r\\n\\r\\n est http hdr_ est http hdr cl est http hdr auth conn ctx est ctx realm auth fail auth mode valid point pars stop pars http header buf mg request info ri array size ri http header ri http header   skip quot buf `` `` `` ri http header   valu skip buf `` \\r\\n ri http header     \\ ri num header pars stop valid http method method est allow post strncmp method `` strncmp method `` post http request compon header name header valu pars http messag buf len mg request info ri request length request len buf len request length reset attribut touch ssl remot ip remot port ri request method ri uri ri http version null ri num header buf  request length  \\ rfc say initi whitespac ingor buf \\ isspac buf buf ri request method skip buf `` `` ri uri skip buf `` `` ri http version skip buf `` \\r\\n pars http header buf ri est log info `` request len d request length est log info `` request uri s ri uri request length http request compon header name header valu pars http request buf len mg request info ri result pars http messag buf len ri result valid http method ri request method strncmp ri http version `` http ri http version skip `` http result result read oper increas nread number byte read read request file fp mg connect conn buf bufsiz nread request len n request len request len buf nread nread bufsiz request len n n pull fp conn buf nread bufsiz nread n nread n request len request len buf nread n recv error propag error process brked high probabl request request len function call mongoos code incom http request process return success non zero request wasnt handl est mg handler mg connect conn mg request info request info mg request info conn est ctx ectx conn ctx est ctx bodi cl est rv est err cl hdr content length html header ct hdr content type html header cl hdr mg header conn `` content length cl hdr point content length valu error check guarante correct rang obtain length alloc buffer bodi read cl atoi cl hdr bodi malloc cl mg read conn bodi cl make sure buffer null termin bodi  cl  x cl bodi null ct hdr mg header conn `` content type ectx est mode est server est rv est http request ectx conn request info request method request info uri bodi cl ct hdr ectx est mode est proxi est rv est proxi http request ectx conn request info request method request info uri bodi cl ct hdr est rv est err est log err `` est error respons code d s \\n est rv est err num str est rv cl hdr free bodi est rv directori embed function etcetera handl request mg connect conn mg request info ri conn request info uri len rv conn request info queri string strchr ri uri null conn request info queri string \\ uri len strnlen s ri uri est uri max len url decod ri uri uri len ri uri uri len remov dot slash ri uri est log info `` s ri uri process request rv est mg handler conn est err rv est log warn `` incom request fail rv d s rv est err num str rv directori embed function etcetera log header mg connect conn header header valu header valu mg header conn header null est log info `` s `` est log info `` \\ s\\ header valu directori embed function etcetera log access mg connect conn mg request info ri date   src addr   strftime date date `` d b y h m s z localtim conn birth time ri conn request info sockaddr string src addr src addr conn client rsa est log info `` s  s  \\ s s http s\\ d fmt src addr date ri request method ri request method `` ri uri ri uri `` ri http version conn status code conn num byte sent log header conn `` refer log header conn `` user agent open ssl error messag ssl error err err err error err `` err error string err null dynam load ssl librari set ctx ssl ctx pointer set ssl option mg context ctx mg connect conn est ctx ectx ssl ctx ssl ctx ec key ecdh null x verifi param vpm null sic   `` est ssl ctx ssl ctx new sslv server method null fc ctx `` ssl ctx new server error s ssl error ctx ssl ctx ssl ctx ectx ctx est ctx conn fc ctx conn request info ev data ctx ssl ctx ssl ctx set verifi ssl ctx ssl verifi peer null set session id context enabl open ssl session reus improv perform set id estxxxxxxxx x valu random number rand byte sic   est log warn `` rng failur set sic s ssl error ssl ctx set session id context ssl ctx sic load ca cert s use verifi client certif ssl ctx set cert store ssl ctx ectx trust cert store ssl code free store ssl ctx later ectx trust cert store null note disabl tls ticket way reus tls session avoid key exchang overhead tls handshak ve enabl session reus session reus work ticket support enabl server want look enabl ticket futur session reus give perform boost option set improv forward secrecti compli est draft ssl ctx set option ssl ctx ssl op sslv ssl op sslv ssl op tlsv ssl op singl ecdh use ssl op ticket set ecdh singl use parm use configur curv use primev ectx ecdh nid setup user select curv ecdh ec key new curv ectx ecdh nid est log info `` use non ecdh curv nid d ectx ecdh nid prime curv ecdh ec key new curv nid x_ primev est log info `` use ecdh curv primev ecdh null est log err `` fail generat temp ecdh parameters\\n ssl ctx set tmp ecdh ssl ctx ecdh ec key free ecdh setup addit cert check includ crl depth purpos vpm x verifi param new enabl crl check ectx enabl crl x verifi param set flag vpm x v flag crl check x v flag crl check x verifi param set depth vpm est tls verifi depth note purpos check keyusag valu present client s cert x verifi param set purpos vpm x purpos ssl client ssl ctx set param ssl ctx vpm x verifi param free vpm set singl use dh paramet applic request capabl ectx dh tmp ssl ctx set option ssl ctx ssl op singl dh use ssl ctx set tmp dh ssl ctx ectx dh tmp dh free ectx dh tmp ectx dh tmp null ectx enabl srp est log info `` enabl tls srp mode\\n ssl ctx set cipher list ssl ctx est cipher list srp server est log err `` fail set ssl cipher suites\\n set applic specif handler provid srp paramet user authent ssl ctx set srp usernam callback ssl ctx ectx est srp usernam cb est log info `` tls srp enabl set tls cipher suit allow disabl anonym null cipher ssl ctx set cipher list ssl ctx est cipher list est log err `` fail set ssl cipher suites\\n ssl ctx use certif ssl ctx ectx server cert est log err `` unabl set server certif ssl ctx use privat key ssl ctx ectx server priv key est log err `` unabl set server privat key need includ cert chain server s certif tls certif messag server reason est draft specifi subordin ca cert includ cacert messag flow client cert chain therfor tls handshak contain server s cert chain ssl ctx use certif chain file ctx ssl ctx ctx est ctx http cert file dynam load ssl librari set ctx ssl ctx pointer reset request attribut mg connect conn conn path info conn request info ev data null conn num byte sent conn consum content conn status code conn close conn request len dynam load ssl librari set ctx ssl ctx pointer valid uri uri conform http www w org protocol rfc rfc sec html sec uri asterisk start slash uri   uri   uri   \\ dynam load ssl librari set ctx ssl ctx pointer process new connect mg connect conn mg request info ri conn request info aliv enabl aliv discard len cl aliv enabl conn ctx enabl keepal aliv import new connect reset receiv buffer credit goe crule conn data len reset request attribut conn conn request len read request null conn conn buf conn buf size conn data len assert conn request len conn data len conn request len conn request len conn data len conn buf size send http error conn `` request larg `` s `` conn request len remot end close connect pars http request conn buf conn buf size ri valid uri ri uri garbag access log just send client send http error conn `` bad request `` pars http request  s  conn data len conn buf conn close strncmp ri http version `` strncmp ri http version `` request valid http version strang send http error conn `` http version support `` s `` log access conn request valid handl cl header ri `` content length null conn content len strtoll cl null mg strcasecmp ri request method `` post mg strcasecmp ri request method `` conn content len conn content len ensur content length valu size est code will accept conn content len est max content len est log warn `` http request content length greater est `` maximum support content length d est max content len send http error conn `` content length larg `` s `` log access conn conn content len est log warn `` http request content length negat valu send http error conn `` bad request `` content length negat conn data len conn buf log access conn conn birth time time null handl request conn log access conn note lsm order import aliv use pars request invalid memmov s memor aliv result later use loop exit condit aliv aliv conn discard buffer data request discard len conn content len conn request len conn content len t conn data len conn request len conn content len conn data len conn data len discard len memmov s conn buf max request size conn buf discard len conn data len discard len conn data len discard len assert conn data len assert conn data len conn buf size conn ctx stop flag aliv enabl conn content len aliv brief est server handl request use applic process est request applic respons open listen socket est request come socket applic use function hand request lib est param ctx pointer est ctx provid est server init est proxi init invok param fd file descriptor read retriev http request client typic tcp socket file descriptor est server handl request use applic incom est request need process request cacert simpleenrol reenrol csrattr request use implement est server applic respons open listen tcp socket incom est request data readi read socket api entri point use allow lib est read request socket respond request est error est error est server handl request est ctx ctx fd mg connect conn socket accept socklen t len ipstr  inet addrstrlen  port sockaddr storag addr ssl err err code est error rv est err rc ctx est log err `` null est context est err ctx ctx mg ctx est log err `` null est mg context est err ctx accept sock fd accept null len sockaddr storag rc getpeernam fd sockaddr addr len rc est log err `` getpeernam fail happen sure caus est err unknown deal ipv ipv addr ss famili af inet memcpi s accept rsa sin sockaddr addr sockaddr port ntoh accept rsa sin sin port inet ntop af inet accept rsa sin sin addr ipstr ipstr af inet memcpi s accept rsa sin sockaddr addr sockaddr port ntoh accept rsa sin sin port inet ntop af inet accept rsa sin sin addr ipstr ipstr est log info `` peer ip address s ipstr est log info `` peer port d port conn mg connect calloc conn max request size conn null fc ctx mg ctx `` s `` creat new connect oom est err malloc conn buf size max request size conn buf conn conn client accept conn birth time time null conn ctx ctx mg ctx conn read timeout ctx server read timeout ip port info earli ssl setup fail error handler correspond info conn request info remot port ntoh conn client rsa sin sin port memcpi s conn request info remot ip conn client rsa sin sin addr s addr conn request info remot ip ntohl conn request info remot ip conn request info ssl est tls setup tls tunnel conn ssl ssl new conn ctx ssl ctx conn ssl null ssl set fd conn ssl conn client sock ssl err ssl accept conn ssl ssl err err code ssl error conn ssl ssl err err code ssl error syscal est log err `` open ssl error rv est err syscal ssl error ssl unknown open ssl error dump open ssl error log learn ossl dump ssl error rv est err unknown ssl error want read ssl error want write est log info `` app use non block socket process new connect conn ssl error want x lookup est log err `` ssl accept error want lookup rv est err unknown ssl error process new connect conn ssl err ssl shutdown conn ssl ssl err open ssl doc say shutdown ssl shutdown conn ssl est log info `` phase ssl shutdown initi shutdown work est log info `` ssl shutdown succeed log error est log warn `` ssl shutdown fail ssl free conn ssl conn ssl null memzero s conn conn max request size free conn rv brief est server handl request use applic process est request applic respons open listen socket est request come socket applic use function hand request lib est param ctx pointer est ctx provid est server init est proxi init invok param fd file descriptor read retriev http request client typic tcp socket file descriptor est server handl request use applic incom est request need process request cacert simpleenrol reenrol csrattr request use implement est server applic respons open listen tcp socket incom est request data readi read socket api entri point use allow lib est read request socket respond request est error free context mg context ctx dealloc ssl context ctx ssl ctx null ssl ctx free ctx ssl ctx dealloc context free ctx brief est server handl request use applic process est request applic respons open listen socket est request come socket applic use function hand request lib est param ctx pointer est ctx provid est server init est proxi init invok param fd file descriptor read retriev http request client typic tcp socket file descriptor est server handl request use applic incom est request need process request cacert simpleenrol reenrol csrattr request use implement est server applic respons open listen tcp socket incom est request data readi read socket api entri point use allow lib est read request socket respond request est error mg stop mg context ctx ctx stop flag free context ctx defin win defin _ symbian__ wsacleanup endif win brief est server handl request use applic process est request applic respons open listen socket est request come socket applic use function hand request lib est param ctx pointer est ctx provid est server init est proxi init invok param fd file descriptor read retriev http request client typic tcp socket file descriptor est server handl request use applic incom est request need process request cacert simpleenrol reenrol csrattr request use implement est server applic respons open listen tcp socket incom est request data readi read socket api entri point use allow lib est read request socket respond request est error mg context mg start user data mg context ctx defin win defin _ symbian__ wsadata data wsastartup makeword data initi critic section global log file lock endif win alloc context initi reason general default todo lsm proper error handl ctx mg context calloc ctx null null ctx user data user data ctx est ctx est ctx user data ctx enabl keepal set ssl option ctx free context ctx null ctx brief est server handl request use applic process est request applic respons open listen socket est request come socket applic use function hand request lib est param ctx pointer est ctx provid est server init est proxi init invok param fd file descriptor read retriev http request client typic tcp socket file descriptor est server handl request use applic incom est request need process request cacert simpleenrol reenrol csrattr request use implement est server applic respons open listen tcp socket incom est request data readi read socket api entri point use allow lib est read request socket respond request est error est error est send csrattr data est ctx ctx csr data csr len http ctx http hdr  est http hdr max  hdrlen csr len csr data send http header snprintf http hdr est http hdr max `` s s s s est http hdr_ est http hdr eol est http hdr stat_ est http hdr eol hdrlen strnlen s http hdr est http hdr max snprintf http hdr hdrlen est http hdr max `` s s s est http hdr ct est http ct csrattr est http hdr eol hdrlen strnlen s http hdr est http hdr max snprintf http hdr hdrlen est http hdr max `` s s s est http hdr ce est http ce base est http hdr eol hdrlen strnlen s http hdr est http hdr max snprintf http hdr hdrlen est http hdr max `` s d s s est http hdr cl csr len est http hdr eol est http hdr eol mg write http ctx http hdr strnlen s http hdr est http hdr max free csr data est err http write send csr bodi mg write http ctx csr data csr len free csr data est err http write free csr data csr data free csr data send respons indic server doe nt csr est send http error ctx http ctx est err http content est err