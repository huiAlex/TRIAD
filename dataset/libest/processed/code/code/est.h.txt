 file est est h public api enrol secur transport novemb copyright c cisco system right reserv ifndef header est h defin header est h ifdef win ifdef libest export defin libest api _ declspec dllexport defin libest api _ declspec dllimport endif defin libest api endif includ openssl ssl h includ openssl engin h includ openssl conf h includ openssl srp h ifdef _ cplusplus `` c endif allow runtim check path segment support ifdef uripars defin path segment support enabl endif defin est max file len defin est max servernam len defin est portnum len defin est max servernam port len est max servernam lenest portnum len defin est max client cert len defin est max path segment len est server est client est proxi est mode est client proxi est client proxi http notunnel est client proxi http tunnel est client proxi sock est client proxi sock est client proxi socksa est client proxi sock hostnam est client proxi proto valu ore defin est client proxi auth defin est client proxi auth basic defin est client proxi auth ntlm defin foreach est error e \\ e est err ctx \\ e est err csr \\ e est err cert \\ e est err key \\ e est err invalid paramet \\ e est err load cacert \\ e est err load trust cert \\ e est err bad mode \\ e est err bad pkcs \\ e est err http write \\ e est err http unsupport \\ e est err http build header \\ e est err http bad req \\ e est err http \\ e est err http content \\ e est err http lock \\ e est err http invalid path segment \\ e est err http path segment support \\ e est err bad content type \\ e est err bad content len \\ e est err ssl ctx \\ e est err auth fail \\ e est err auth fail tlsuid \\ e est err auth pend \\ e est err ca enrol fail \\ e est err ca enrol retri \\ e est err wrong method \\ e est err x sign \\ e est err x ver \\ e est err x cn \\ e est err x attr \\ e est err x pubkey \\ e est err malloc \\ e est err ssl write \\ e est err ssl read \\ e est err ssl new \\ e est err ssl ctx new \\ e est err ssl connect \\ e est err ssl cipher list \\ e est err pem read \\ e est err null callback \\ e est err ip getaddr \\ e est err ip connect \\ e est err invalid server \\ e est err invalid port num \\ e est err client invalid key \\ e est err client initi \\ e est err zero length buf \\ e est err read buffer small \\ e est err buf exceed max len \\ e est err certif \\ e est err cert \\ e est err fqdn mismatch \\ e est err syscal \\ e est err csr \\ e est err csr attr miss \\ e est err invalid digest \\ e est err cacert verif \\ e est err invalid token \\ e est err invalid retri valu \\ e est err bad x \\ e est err bad base \\ e est err bad asn hex \\ e est err bad asn hex \\ e est err bad asn hex \\ e est err srp strength low \\ e est err srp userid bad \\ e est err srp pwd bad \\ e est err cb fail \\ e est err client proxi mode support \\ e est err invalid client proxi protocol \\ e est err invalid client proxi auth \\ e est err unknown defin generat defin generat string string string est error brief use indic error condit applic layer lib est function error indic enumer applic check return error indic grace handl error error occur lib est est err valu zero \\n \\n est err error occur \\n est err ctx est ctx provid invok function \\n est err csr pkcs csr provid invok function \\n est err cert valid x certif provid invok function \\n est err key evp pkey provid invok function \\n est err invalid paramet invalid argument provid function \\n est err load cacert ca certifict provid load \\n est err load trust cert certif chain trust certif load \\n est err bad mode est oper attempt use wrong mode oper valid mode client server proxi est oper perform certain mode \\n est err bad pkcs pkcs csr receiv client corrupt \\n est err http write error occur write http respons socket \\n est err http unsupport est server sent unsupport http status code respons \\n est err http build header http header built correct \\n est err http bad req http request bad report server \\n est err http http request inform current server \\n est err http content content request avail \\n est err http lock resourc access lock \\n est err http invalid path segment uri path segment pass invalid contain invalid charact \\n est err http path segment support build est doe support use addit path segment uri est need rebuilt uripars librari support path segment \\n est err bad content type http content type header request invalid \\n est err bad content len http content length header request specifi valu larg \\n est err ssl ctx applic did provid valid ssl ctx refer api \\n est err auth fail est server unabl authent est client \\n est err auth fail tlsuid authent failur invalid challeng password pkcs csr \\n est err auth pend http authent challeng sent client respons arriv \\n est err ca enrol fail certif author unabl sign pkcs csr \\n est err ca enrol retri certif author request client retri enrol request futur like ca configur automat enrol \\n est err wrong method invalid http method post use request \\n est err x sign error occur open ssl librari tri sign pkcs csr \\n est err x ver error occur open ssl librari tri set version pkcs csr \\n est err x cn error occur open ssl librari tri set common pkcs csr \\n est err x attr error occur open ssl librari tri set x attribut pkcs csr \\n est err x pubkey error occur open ssl librari tri set public key pkcs csr \\n est err malloc unabl alloc malloc like indic critic failur host \\n est err ssl write error occur tls layer tri write socket \\n est err ssl read error occur tls layer tri read socket \\n est err ssl new error occur open ssl librari tri alloc ssl refer \\n est err ssl ctx new error occur open ssl librari tri alloc ssl ctx refer \\n est err ssl connect error occur open ssl librari tri establish tls session server \\n est err ssl cipher list error occur open ssl librari tri set allow tls cipher suit \\n est err pem read error occur open ssl librari tri read pem encod pkcs csr corrupt pkcs \\n est err null callback applic layer fail provid requir callback function request est oper \\n est err ip getaddr unabl resolv server host \\n est err ip connect unabl connect request host port \\n est err invalid server server provid lib est invalid null exceed maximum server length \\n est err invalid port num tcp port number provid lib est invalid greater \\n est err client invalid key certif privat key provid lib est load privat key match public key certif \\n est err client initi applic attempt use lib est api prior invok est client init \\n est err zero length buf certif receiv server invalid length \\n est err read buffer small o buffer provid read data socket larg receiv respons server \\n est err buf exceed max len est server sent cacert respons exceed maximum size allow \\n est err certif attempt copi cert context prior est oper perform \\n est err cert certif trust certif list provid lib est \\n est err fqdn mismatch est server did match fulli qualifi domain server s x certif \\n est err syscal open ssl librari report error attempt establish tls session \\n est err csr pkcs csr provid lib est contain signatur lib est requir csr lib est respons sign csr \\n est err csr attr miss pkcs csr receiv est client doe contain requir csr attribut \\n est err invalid digest invalid digest type request \\n est err cacert verif valid ca certif chain receiv est server fail \\n est err invalid token invalid author token receiv \\n est err invalid retri valu invalid miss retri receiv server \\n est err bad x invalid corrupt x certif provid lib est \\n est err bad base invalid corrupt csr attribut base encod string provid \\n est err bad asn hex invalid corrupt csr attribut asn hex string provid \\n est err bad asn hex csr attribut asn hex string \\n est err bad asn hex csr attribut asn hex string \\n est err srp strength low srp strength request applic small \\n est err srp userid bad srp user id accept \\n est err srp pwd bad srp password accept \\n est err cb fail applic layer facil fail \\n est err client proxi mode support lib est built libcurl support libcurl requir client proxi mode \\n est err invalid client proxi protocol invalid proxi protocol specifi configur client mode http sock proxi \\n est err invalid client proxi auth invalid proxi authent mode specifi configur client mode http sock proxi \\n est err error definit use est err foreach est error generat est err est error libest api est err string   defin est err num str x est err string  x  auth auth basic auth digest auth token auth fail est http auth mode http auth requir http auth requir est http auth requir est cert format pem est cert format der est cert format max est cert format defin est format pem est cert format pem defin est format der est cert format der allow log filter desir detail level bitmask filter ad new log level order maintain base urgenc log messag est log lvl err est log lvl warn est log lvl info est log level defin max realm defin max nonc defin max uidpwd defin max nc defin max qop defin max respons defin min csrattr defin max csrattr defin min asn csrattr defin max csrattr withpop defin max token error defin max token error desc defin max auth token len defin max http method len follow valu defin minimum maximum valu timeout valu ssl read oper valu use est client proxi oper defin est ssl read timeout min defin est ssl read timeout max defin est ssl read timeout def est http auth hdr brief structur use pass http authent paramet applic lib est doe contain user databas authent user expect applic perform user authent extern authent server radius structur allow http authent credenti pass lib est http layer applic var est http auth hdr mode contain http authent mode use basic digest var est http auth hdr user contain user id est client authent var est http auth hdr pwd contain password est client authent http basic authent use var est http auth hdr uri contain uri est client http digest authent var est http auth hdr cnonc contain nonc est client http digest authent var est http auth hdr qop contain oper est client http digest authent var est http auth hdr nc contain nonc count est client http digest authent var est http auth hdr nonc contain server nonc http digest authent var est http auth hdr respons contain client s digest valu verifi var est http auth hdr auth token contain client s token valu verifi est http auth mode mode user pwd uri cnonc qop nc nonc respons auth token est http auth hdr defin valid code applic layer s auth credenti callback function provid est http auth cred success est http auth cred avail est http auth cred rc est ctx brief structur use maintain state est oper behalf applic singl context use repres singl instanc est client est server est proxi server member structur public access applic use function provid lib est api manag context context creat use est client init est server init est proxi init context longer need applic shoud invok est destroy releas memori associ context est ctx est ctx auth credenti cb brief defin prototyp callback function resid applic code applic function callback use est client set auth cred cb api function callback call est client librari requir http authent credenti callback function take input pointer est http auth hdr structur callback function look mode structur element determin type credenti requir mode set auth basic auth digest callback function suppli user pwd valu mode set auth token callback suppli auth token valu auth token valu base encod string repres access token est http auth cred rc auth credenti cb est http auth hdr auth credenti begin public api prototyp libest api est error est enabl crl est ctx ctx libest api est error est init logger est log level lvl loggerfunc va list libest api est api level libest api est version libest api est enabl backtrac enabl libest api est error est set ex data est ctx ctx ex data libest api est ex data est ctx ctx libest api est ctx est server init ca chain ca chain len cacert resp chain cacert resp chain len est cert format cert format http realm x tls cert evp pkey tls key libest api est ctx est proxi init ca chain ca chain len cacert resp chain cacert resp chain len est cert format cert format http realm x tls cert evp pkey tls key uid pwd libest api est error est destroy est ctx ctx libest api est error est server set auth mode est ctx ctx est http auth mode amod libest api est server generat auth digest est http auth hdr ah ha libest api est error est server start est ctx ctx libest api est error est server stop est ctx ctx libest api est error est server enabl tls est ctx ctx libest api est error est server enabl srp est ctx ctx cb ssl s ad arg libest api est error est server enabl pop est ctx ctx libest api est error est server disabl pop est ctx ctx libest api est error est server handl request est ctx ctx fd libest api est error est server set dh parm est ctx ctx dh dh libest api est error est server init csrattr est ctx ctx csrattr crsattr len libest api est error est server set retri period est ctx ctx second libest api est error est server set ecdh curv est ctx ctx nid libest api est error est server enforc csrattr est ctx ctx libest api est error est server set read timeout est ctx ctx timeout est proxi specif function libest api est error est proxi start est ctx ctx libest api est error est proxi stop est ctx ctx libest api est error est proxi set server est ctx ctx server port libest api est error est proxi set auth mode est ctx ctx est http auth mode amod libest api est error est proxi set read timeout est ctx ctx timeout libest api est error est proxi set auth cred cb est ctx ctx auth credenti cb follow function use est client libest api est ctx est client init ca chain ca chain len est cert format cert format cert verifi cb x libest api est error est client set auth est ctx ctx uid pwd x client cert evp pkey privat key libest api est error est client set auth cred cb est ctx ctx auth credenti cb libest api est error est client set server est ctx ctx server port path segment libest api est error est client set proxi est ctx ctx est client proxi proto proxi proto proxi server proxi port proxi auth usernam password libest api est error est client provis cert est ctx ctx cn pkcs len ca cert len evp pkey new public key libest api est error est client enrol est ctx ctx cn pkcs len evp pkey new public key libest api est error est client enrol csr est ctx ctx x req csr pkcs len evp pkey priv key libest api est error est client reenrol est ctx ctx x cert pkcs len evp pkey priv key libest api est error est client copi enrol cert est ctx ctx pkcs libest api est error est client csrattr est ctx ctx csr data csr len libest api est error est client cacert est ctx ctx ca cert len libest api est error est client copi cacert est ctx ctx ca cert libest api est error est client set sign digest est ctx ctx nid libest api est error est client copi retri est ctx ctx retri delay time t retri time libest api est error est client set read timeout est ctx ctx timeout libest api est error est client enabl basic auth hint est ctx ctx libest api est error est client forc pop est ctx ctx libest api est error est client unforc pop est ctx ctx libest api est error est client enabl srp est ctx ctx strength uid pwd libest api est client http status est ctx ctx follow callback entri point set applic act est server proxi libest api est error est set ca enrol cb est ctx ctx cb pkcs p len pkcs pkcs len user id x peer cert path seg ex data libest api est error est set ca reenrol cb est ctx ctx cb pkcs p len pkcs pkcs len user id x peer cert path seg ex data libest api est error est set csr cb est ctx ctx cb intcsr len path seg ex data libest api est error est set cacert cb est ctx ctx cb intcsr len path seg ex data libest api est error est set http auth cb est ctx ctx cb est ctx est http auth hdr x libest api est error est set http auth requir est ctx ctx est http auth requir requir libest api est error est add attribut helper x req req nid string chtype libest api est error est attribut helper der ptr der len new nid libest api est error est decod attribut helper csrattr csrattr len der ptr der len follow helper function deal open ssl data type cert key libest api x req est read x request csr csr len est cert format csr format libest api evp pkey est load key key key len format libest api est convert pb pem cert p cert len pem helper macro applic use initi initi open ssl brief est app startup use applic initi open ssl librari call prior use function lib est api helper function invok crypto malloc init err load crypto string open ssl add algorithm engin load builtin engin ssl librari init ssl load error string defin est app startup \\ crypto malloc init \\ err load crypto string open ssl add algorithm \\ engin load builtin engin \\ ssl librari init \\ ssl load error string brief est app shutdown use applic initi open ssl librari call prevent memori leak open ssl librari helper function invok conf modul unload obj cleanup evp cleanup engin cleanup crypto cleanup ex data err remov thread state err free string defin est app shutdown \\ conf modul unload \\ obj cleanup evp cleanup engin cleanup \\ crypto cleanup ex data err remov thread state null \\ err free string ifdef _ cplusplus endif endif