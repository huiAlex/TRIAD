 curlx sltosi slnum ifdef _ intel compil pragma warn push pragma warn disabl convers lose signific bit endif assert slnum curl assert slnum curl mask sint endif slnum curl mask sint ifdef _ intel compil pragma warn pop endif parsed return parsed ok fine convers parsed fail fail convert parsed later time overflow far end time t parsed sooner time underflow low end time t parsed date time t output return day monday sunday checkday check size t len len weekday   curl wkday   est client curl raw equal check   return day monday sunday checkmonth check curl month   est client curl raw equal check   offset real offset time zone offset gmt input number second timezon nt legal checktz check tzinfo tz tz tz   est client curl raw equal check offset time zone offset gmt input number second timezon nt legal skip white date skip nt letter digit date isalnum date date tm time epoch gmt time zone similar standard mktime function gmt doe nt suffer various bug portabl problem system implement time t timegm tm tm month day cumul   month year leap day tm tm year nt support year caus function negat valu year tm tm year month tm tm mon month year month month month month year month month month leap day year tm tm mon leap day leap day leap day leap day time t year leap day month day cumul  month  tm tm mday tm tm hour tm tm min tm tm sec parsed return parsed ok fine convers parsed fail fail convert parsed later time overflow far end time t parsed sooner time underflow low end time t parsed date time t output time t t wdaynum day week number mon sun monnum month year number mdaynum day month hournum minnum secnum yearnum tzoff tm tm assum dignext date mday indat date save origin pointer max part date skip white date isalpha date come buf  est curl max str  size t len sscanf date ``  abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz  buf len strnlen s buf est curl max str wdaynum wdaynum checkday buf len wdaynum monnum monnum checkmonth buf monnum tzoff just time zone string tzoff checktz buf tzoff parsed fail bad string date len isdigit date digit val end secnum sscanf date `` d d d hournum minnum secnum time stamp date secnum sscanf date `` d d hournum minnum time stamp second date secnum lval error old errno old errno errno set errno lval strtol date end error errno error old errno set errno old errno error parsed fail lval max lval min parsed fail val curlx sltosi lval tzoff end date val indat date date   date   digit valu equal account sort funni time zone diff preced plus minus time zone indic pick frequent use mention edg number document `` iso c x propos timezon function http david tribbl com text cxtimezon html authorit sourc exact maximum time zone offset speak tzoff val val prefix indic local time compar gmt need ther revers math want tzoff date   tzoff tzoff end date yearnum monnum mdaynum digit year month day yyyymmdd yearnum val monnum val month mdaynum val dignext date mday mdaynum val val mdaynum val dignext date year dignext date year yearnum yearnum val yearnum yearnum yearnum yearnum mdaynum dignext date mday parsed fail date end secnum secnum minnum hournum time make zero mdaynum monnum yearnum lack vital info fail parsed fail time t bit time t hold date begin yearnum output xfffffff parsed later endif yearnum output parsed sooner mdaynum monnum hournum minnum secnum parsed fail clear illeg date tm tm sec secnum tm tm min minnum tm tm hour hournum tm tm mday mdaynum tm tm mon monnum tm tm year yearnum timegm return time t time t bit architectur featur bit system bit time t deal year system bit time t mktime return date utc januari aix t timegm tm time zone adjust cast t compar negat t add time zone diff local time zone gmt delta tzoff tzoff delta t delta t time t overflow t delta output t parsed ok field find rfc token string entri pstr point string contain word separ white white space `` `` `` word option quot use `` `` `` `` comment surrround filter exit pstr move delimit past field string mutil termin return pointer word null error htnext field pstr p start null pstr pstr null p pstr strip white space delimit p isspac p p p p p p pstr p null field p quot field start p p p p p \\\\ p p skip escap char kr need stop p quot field start p p p p p \\\\ p p skip escap char kr need stop p comment p p p p \\\\ p p skip escap char p spool field start p p isspac p p p p p got p p \\ pstr p start function pars authent token server server request http digest authent token requir generat valid authent respons futur http request est error est io pars auth token est ctx ctx hdr rv est err p hdr token null valu null diff errno t safec rc header come basic digest field skip token htnext field p token htnext field p est strcasecmp s token `` realm valu htnext field p eok strncpi s ctx realm max realm valu max realm rv est err invalid token rv est err invalid token est strcasecmp s token `` nonc valu htnext field p eok strncpi s ctx s nonc max nonc valu max nonc rv est err invalid token rv est err invalid token est strcasecmp s token `` qop valu htnext field p valu   \\ est log warn `` unsupport qop valu s valu safec rc memcmp s valu `` auth `` auth `` auth diff safec rc eok est log info `` memcmp s error x x o\\n safec rc diff safec rc eok est log warn `` unsupport qop valu s valu rv est err invalid token est strcasecmp s token `` algorithm valu htnext field p est strcasecmp s valu `` md est log err `` unsupport digest algorithm s valu support md moment rv est err invalid token est strcasecmp s token `` error valu htnext field p eok strncpi s ctx token error max token error valu max token error rv est err invalid token rv est err invalid token est strcasecmp s token `` error descript valu htnext field p eok strncpi s ctx token error desc max token error desc valu max token error desc rv est err invalid token rv est err invalid token est log warn `` unsupport auth token ignor s token rv est err invalid token memzero s ctx s nonc max nonc rv function pars authent token server server request http digest authent token requir generat valid authent respons futur http request http header pars http header buf num header http header hdrs hdr end errno t safec rc num header hdrs malloc http header max header hdrs est log err `` malloc failur null offset header delimint safec rc strstr s buf strnlen s buf rsize max str `` \\r\\n\\r\\n max header delimit len hdr end safec rc eok est log info `` strstr s error x x o\\n safec rc skip line skip buf `` \\r\\n max header hdrs   skip quot buf `` `` `` hdrs   valu skip buf `` \\r\\n fflush stdout est log info `` http header s s hdrs   hdrs   valu fflush stdout hdrs     \\ num header buf hdr end est log info `` d http headers\\n num header hdrs function pars http status code header hand code handl est http stack unrecogn code result error note http expect est io pars respons status code buf strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max strncmp buf est http hdr_ strnlen s est http hdr_ est http hdr max est log err `` unhandl http respons s buf function search process www authent header server result set auth mode valu context www authent header valu header invalid set auth mode failur set multipl authent header process est io pars http auth request est ctx ctx http header hdrs hdr cnt est error rv auth walk header look www authent process erron second includ ignor hdr cnt strncmp hdrs   est http hdr auth auth strncmp hdrs   valu `` basic ctx auth mode auth basic pars realm rv est io pars auth token ctx hdrs   valu rv est err ctx auth mode auth fail strncmp hdrs   valu `` digest ctx auth mode auth digest pars realm nonc rv est io pars auth token ctx hdrs   valu rv est err ctx auth mode auth fail strncmp hdrs   valu `` bearer ctx auth mode auth token pars realm possibl token error field rv est io pars auth token ctx hdrs   valu rv est err ctx auth mode auth fail est log err `` unsupport www authent method ctx auth mode auth fail auth est log err `` www authent header ctx auth mode auth fail function take list header server respons walk header look retri respons header valu pars save away est context valu format repres ascii string format count number second client wait retri request second format time date stamp point time client retri request result function set retri valu context retri header receiv receiv pars valu zero set valu receiv note est client current doe support time date format respons process respons format est error est io pars http retri resp est ctx ctx http header hdrs hdr cnt est error rv est err invalid retri valu cmp result diff rc temp ll initi assum retri header ctx retri delay ctx retri date hdr cnt cmp result strcasecmp s hdrs   est http hdr retri est http hdr retri diff cmp result eok diff est log info `` retri valu s hdrs   valu determin valu date time string integ repres number second client wait isalpha hdrs   valu ifdef retri delay time support rc convert date time string time t rc parsed hdrs   valu ctx retri date rc parsed ok est log err `` retri valu pars format current support est log err `` retri valu correct format endif make sure s digit make sure s larger byte integ cach away valu return retri delay rc strisdigit s hdrs   valu max decim place rc temp ll atol hdrs   valu temp ll max ctx retri delay temp ll rv est err ca enrol retri est log err `` retri valu larg est log err `` retri valu pars est log err `` retri header miss rv function verifi content type header return length content header content type import exampl content type expect pkcs simpl enrol est io check http hdrs http header hdrs hdr cnt est oper op cl content type present content length present cmp result travers http header process one need check hdr cnt content type memcmp s hdrs   est http hdr ct est http hdr ct est http hdr ct cmp result cmp result content type present verifi content pkcs data memcmp s hdrs   valu strnlen s est op map  op  content type est op map  op  length est op map  op  content type strnlen s est op map  op  content type est op map  op  length cmp result cmp result est log err `` http content type s hdrs   valu content length memcmp s hdrs   est http hdr cl est http hdr cl est http hdr cl cmp result cmp result content length present cl atoi hdrs   valu make sure necessari header present content type present est log err `` miss http content type header content length present est log err `` miss http content length header cl function verifi content type header return length content header content type import exampl content type expect pkcs simpl enrol est ssl read ssl ssl buf buf max sock read timeout timeout read fd rv pollfd pfd load timev pass select timeout sock read timeout read fd ssl fd ssl pfd fd read fd pfd event pollin pfd revent errno rv poll pfd timeout rv est log err `` socket poll timeout data receiv server `` rv est log err `` socket read failur errno d errno ssl read ssl buf buf max function extract data ssl context put buffer est io read raw ssl ssl buf buf max read cnt sock read timeout cur cnt peek read buf read cnt cur cnt est ssl read ssl buf buf max sock read timeout cur cnt est log err `` tls read error ossl dump ssl error est err ssl read read cnt cur cnt multipl call ssl read requir http payload cur cnt read cnt buf max cur cnt est ssl read ssl buf read cnt buf max read cnt sock read timeout cur cnt est log err `` tls read error ossl dump ssl error est err ssl read read cnt cur cnt read cnt buf max ssl peek ssl peek read buf est log err `` buffer small receiv messag est err read buffer small est err function provid primari entri point modul s use est client read http respons server data read ssl context http pars invok est err return raw buf buffer freed caller freed est error est io respons est ctx ctx ssl ssl est oper op buf payload len rv est err http header hdrs hdr cnt http status raw buf payload buf payload raw len raw buf malloc est ca max raw buf null est log err `` unabl alloc memori est err malloc memzero s raw buf est ca max payload raw buf read raw data ssl connect rv est io read raw ssl raw buf est ca max raw len ctx read timeout rv est err est log info `` valid respons process free raw buf rv raw len est log warn `` receiv http respons server free raw buf est err http est log info `` read d byte http data raw len pars http header status look status success http status est io pars respons status code raw buf ctx http status http status hdrs pars http header payload hdr cnt est log info `` http status d receiv http status check status header server accept request http status server report ok est log err `` server respond content op est op csrattr rv est err http status rv est err http rv est err unknown server ask retri est log info `` est server respond retri rv est io pars http retri resp ctx hdrs hdr cnt est log err `` http respons est server bad request rv est err http bad req server request user auth credenti est log info `` est server request user authent check ve tri authent bail time auth mode set ctx auth mode auth digest ctx auth mode auth basic ctx auth mode auth token ctx auth mode auth fail rv est err auth fail est io pars http auth request ctx hdrs hdr cnt rv est err auth fail est log err `` server respond content attempt access lock rv est err http lock unsupport http respons est log err `` unsupport http respons est server d http status rv est err unknown http respons given want handl est log err `` http respons est server d http status rv est err http unsupport rv est err content type content length header verifi http respons contain correct data payload len est io check http hdrs hdrs hdr cnt op est log info `` http content len d payload len payload len est ca max est log err `` content length larger maximum valu d `` est ca max rv est err unknown payload len buf null payload len payload len buf null alloc buffer hold payload pass payload buf malloc payload len payload buf est log err `` unabl alloc memori free raw buf free hdrs est err malloc memcpi s payload buf payload len payload payload len buf payload buf raw buf free raw buf hdrs free hdrs rv