 c unit test user stori proxi csr attribut novemb copyright c cisco system right reserv includ stdio h ifndef win includ unistd h endif includ est h includ curl curl h includ `` curl util h includ `` test util h includ `` st server h includ `` st proxi h includ openssl ssl h ifdef cunit includ `` cunit basic h includ `` cunit autom h endif cacert null cacert len defin server port defin proxi port ifndef win defin cacert `` ca est ca cacert crt defin trust cert `` ca trustedcert crt defin server ut cacert `` ca est ca cacert crt defin server ut pubkey `` est client ut keypair defin server ip `` defin cacert `` ca est ca cacert crt defin trust cert `` ca trustedcert crt defin server certkey `` ca est ca privat estservercertandkey pem defin cacert `` ca\\\\est ca\\\\cacert crt defin trust cert `` ca\\\\trustedcert crt defin server ut cacert `` ca\\\\est ca\\\\cacert crt defin server ut pubkey `` est client ut keypair defin server ip `` defin cacert `` ca\\\\est ca\\\\cacert crt defin trust cert `` ca\\\\trustedcert crt defin server certkey `` ca\\\\est ca\\\\private\\\\estservercertandkey pem endif defin test attr pop `` mas gcsq gsib dqejbw\\ defin test attr nopop `` mhew laydi dc cmsugag aw ydi dc eexl qyxjz zsbtrvqg yxmg mi otku mi bk yxrh bglghkg bzqmeag igcssk aw mccaebcz ai bg oinw ex gx mzugfyc ug uvuigfz idiu otk lj zgfyqyhkw ybaqebfg\\ defin test attr nopoppop `` mhww laydi dc cmsugag aw ydi dc eexl qyxjz zsbtrvqg yxmg mi otku mi bk yxrh bglghkg bzqmeag igcssk aw mccaebcz ai bg oinw ex gx mzugfyc ug uvuigfz idiu otk lj zgfyqyhkw ybaqebfg yjko zihvc naqk h\\ defin test attr popad `` mhww laydi dc cmsugag aw ydi dc eexl qyxjz zsbtrvqg yxmg mi otku mi bk yxrh bglghkg bzqmeag igcssk aw mccaebcz ai bg oinw ex gx mzugfyc ug uvuigfz idiu otk lj zgfyqyhkw ybaqebfg yjko zihvc naqk h\\ defin test attr `` mcygbi gaqebarygcsq gsib dqejbw yfkeeacigcwcgsafl aw qcag\\ defin test attr `` maa\\ defin test attr `` ma\\ defin test attr pop `` mas gcsq gsib dqejbw\\ defin test attr `` mathisi bad gcsq gsib dqejbw\\ defin test attr `` migsmfg gag aj frexl qyxjz zsbtrvqg yxmg mi otku mi bk yxrh exl qyxjz zsbtrvqg yxmg mi otku bk yxrh exl qyxjz zsbtrvqg yxmg mi otku ncbk yxrh bgkqhki gw bcqcw ig ydi dc bmrs tgvbhcn nl ifnfvcbhci ay ljk osx igrhd gegbi gaqebary\\ defin test attr_ `` mhow laydi dc cmsugag aw ydi dc eexl qyxjz zsbtrvqg yxmg mi otku mi bk yxrh bglghkg bzqmeag igcssk aw mccaebcz ai bg oinw ex gx mzugfyc ug uvuigfz idiu otk lj zgfyqyhkw ybaqebfg yhkw ybaqebfg\\ defin test attr pop `` migfmcw gag aj el bg oinw mgag bbmzugfyc ug uvuigfz idiu otk lj ig zgfyqyjyiziawudbaicbgkr jamdagg baqsw ig ydi dc bmrs tgvbhcn nl ifnfvcbhci ay ljk osx igrhd gegbi gaqebarygbi gaqebarygcsq gsib dqejbw\\ defin test attr_ `` mhuw jw ydi dc cmsagag aw ydi dc eex rqyxjz zsbtrvqg yxmg mi otku mg yjyiziawudbaicbgkr jamdagg baqsw ig ydi dc bmrs tgvbhcn nl ifnfvcbhci ay ljk osx igrhd gegbi gaqebarygbi gaqebary\\ defin test attr pop `` migamcc gag aj bg oinw mgag bbmuugfyc ug uvuigfz idiu otk lj igcwcgsafl aw qcag yjki qdaw iiaqelmcigag ateb exl qyxjz zsbtrvqg yxmg mi otku msbk yxrh bgcr bg ebaqewbgcr bg ebaqewbgkqhki gw bcqc\\ defin test attr_ `` mhqw jw ydi dc cmsagag aw ydi dc eex rqyxjz zsbtrvqg yxmg mi otku mg yjyiziawudbaicbgkr jamdagg baqsw iqydi dc bmro tgfbhcn nl ifnfvcbhci ay ljk osx igrhd ayhkw ybaqebfg yhkw ybaqebfg\\ defin test attr_ `` mihmgqgag aj fd bg oinw mgag bbnrugfyc ug uvuigfz idiu otk lj ig mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw bglghkg bzqmeag igcssk aw mccaebcz bl bg oinw ex xh nc ugfyc ug uvuigfz idiu otk lj zgfysax mj mntyodkw mtiz ndunzg mdey mz qnjc otbh yj ey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qgbys gaqebarygbi gaqebary\\ defin test attr_ `` mihmgqgag aj fd bg oinw mgag bbnrugfyc ug uvuigfz idiu otk lj ig mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw bglghkg bzqmeag igcssk aw mccaebcz bm bg oinw ex xx nd ugfyc ug uvuigfz idiu otk lj zgfysax mj mntyodkw mtiz ndunzg mdey mz qnjc otbh yj ey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qbgcr bg ebaqewbgcr bg ebaqew\\ defin test attr_ `` mihmgqgag aj fd bg oinw mgag bbnrugfyc ug uvuigfz idiu otk lj ig mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw bglghkg bzqmeag igcssk aw mccaebcz br bg oinw ex zbni ugfyc ug uvuigfz idiu otk lj zgfysax mj mntyodkw mtiz ndunzg mdey mz qnjc otbh yj ey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qmtiz ndugbi gaqebarygbi gaqebary\\ defin test attr pop `` miibbj bk bg oinw ix xqydi dc dbg oinw qtuvbhcn nl ifnfvcbhci ay ljk osi idey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mayjyiziawudbaicbgkr jamdagg baqswaw ydi dc bmwqtyl bhcn nl ifnfvcbhci ay ljk osx igrhd geg mtiz ndunzg mdey mz qnjc otax mj mntyodkw ywix mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntey mz qbgcr bg ebaqewbgcr bg ebaqewbgkqhki gw bcqc\\ defin test attr `` mihtmigbbg oinw ixeg eb w icapgag aw ydi dc ecg eceh ax mj mntyodkw qujdrevgex rqyxjz zsbtrvqg yxmg mi otku mh qfmtiz nduubtey mz qfg ux mj mnro fmtiz nduc faaaadeaaaay aaaamw aaadqaaaahgo amqay admanaabglghkg bzqmeag igcssk aw mccaebcz ai bg oinw ex gx mzugfyc ug uvuigfz idiu otk lj zgfyqyhkw ybaqebfg yhkw ybaqebfg ebaa\\ defin test_ nopop `` miid dccamgag aj gcao gag aw ydi dc eeiox mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtisztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw efqyxjz zsbtrvqg yxmg mi otku mi ax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otagcwcgsafl aw qcag yjki qdaw iiaqelmg gag atfk ejqyxjz zsbtrvqg yxmg mi otku msbk yxrh idey mz qnjc otax mj mntyodkw mtiz ndunzg mgfi mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndux mj mnqyhkw ybaqebfg yhkw ybaqebfg\\ defin test_ nopop `` miid tccaqgag aj gcas gag aw ydi dc eeisx mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbnrugfyc ug uvuigfz idiu otk lj ig mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw bglghkg bzqmeag igcssk aw mccaebcz br bg oinw ex zbni ugfyc ug uvuigfz idiu otk lj zgfysax mj mntyodkw mtiz ndunzg mdey mz qnjc otbh yj ey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qmtiz ndugbi gaqebarygbi gaqebary\\ defin test_ pop `` miiebz ccamgag aj gcao gag aw ydi dc eeiox mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtisztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw efqyxjz zsbtrvqg yxmg mi otku mi ax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otagcwcgsafl aw qcag yjki qdaw iiaqelmg gag atfk ejqyxjz zsbtrvqg yxmg mi otku msbk yxrh idey mz qnjc otax mj mntyodkw mtiz ndunzg mgfi mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndux mj mnqyhkw ybaqebfg yhkw ybaqebfg yjko zihvc naqk h\\ defin test attr `` miienz ccagag aj gcaugag aw ydi dc eem ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otasztey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdax mj mntyodkw em ux mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otaw mtiz ndunzg mbjl mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mdey mz qnjc otatuvbhcn nl ifnfvcbhci ay ljk osi idey mz qnjc otax mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntyodkw mtiz ndunzg mayjyiziawudbaicbgkr jamdagg baqswaw ydi dc bmwqtyl bhcn nl ifnfvcbhci ay ljk osx igrhd geg mtiz ndunzg mdey mz qnjc otax mj mntyodkw ywix mj mntyodkw mtiz ndunzg mdey mz qnjc otax mj mntey mz qbgcr bg ebaqewbgcr bg ebaqew\\ defin est ut max cmd len est ctx ectx clean start server manual enrol nid rv rv st start server port server certkey server certkey `` test realm cacert trust cert `` ca est exampl ca cnf manual enrol nid rv rv start est proxi act ra rv st proxi start proxi port server certkey server certkey `` test realm cacert trust cert `` estus `` estpwd `` server port nid sleep rv routin call cunit initi test suit use alloc data open resourc requir test case init suit rv cmd  est ut max cmd len  printf `` start est server csr attribut unit test \\n gen keypair use est proxi test snprintf cmd est ut max cmd len `` openssl ecparam primev genkey s server ut pubkey printf `` s\\n cmd rv cmd read ca certif cacert len read binari file cacert cacert cacert len start server test need talk server clean start instanc est server rv start server rv routin call cunit uniniti test suit use dealloc data close resourc use test case destroy suit st stop st proxi stop sleep handl csrattr request csr len path seg app data csr data csr len strlen test attr csr data malloc csr len strncpi csr data test attr csr len csr data  csr len  csr data handl corrupt csrattr request csr len path seg app data csr data csr len strlen test attr csr data malloc csr len strncpi csr data test attr csr len csr data  csr len  csr data handl csrattr request csr len path seg app data csr data csr len strlen test attr csr data malloc csr len strncpi csr data test attr csr len csr data  csr len  csr data handl correct csrattr request csr len path seg app data csr data csr len strlen test attr csr data malloc csr len strncpi csr data test attr csr len csr data  csr len  csr data handl nopop csrattr request csr len path seg app data csr data csr len strlen test attr nopop csr data malloc csr len strncpi csr data test attr nopop csr len csr data  csr len  csr data handl csrattr request csr len path seg app data csr data csr len csr data null csr data callback function pass est proxi init proxi manual cert verifi x cur cert openssl cert error bio bio err bio err bio new fp stderr bio noclos approv print specif cert printf `` s open ssl est server cert verif fail follow error openssl cert error d s \\n _ function__ openssl cert error x verifi cert error string openssl cert error printf `` fail cert \\n x print fp stdout cur cert print signatur use fingerprint fingerprint check anticip valu determin server s cert approv x signatur print bio err cur cert sig alg cur cert signatur openssl cert error x v err unabl crl approv bio free bio err approv test exercis server variat trigger est client csrattr test est ctx ctx pkey null cacert null cacert len est error rc est err evp pkey priv key csr len csr data null sleep log func nm read ca certif cacert len read binari file server ut cacert cacert cu assert cacert len read privat key file priv key read privat key server ut pubkey priv key null printf `` \\n error read privat key file s\\n server ut pubkey ctx est client init cacert cacert len est cert format pem proxi manual cert verifi cu assert ctx null rc est client set auth ctx `` `` null priv key cu assert rc est err est client set server ctx server ip proxi port null clear callback est set csr cb ectx null printf `` \\n unabl set est csr attribut callback abort \\n exit clear csrattr rc est server init csrattr ectx null cu assert rc est err data rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len cu assert csr data null real base string pass rc est server init csrattr ectx test attr pop strlen test attr pop cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len est set csr cb ectx handl csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit callback supersed init csrattr rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len est set csr cb ectx handl corrupt csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit callback supersed init csrattr rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len est set csr cb ectx handl csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit callback supersed init csrattr rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len est set csr cb ectx handl correct csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit callback supersed init csrattr rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr cu assert strncmp test attr csr data csr len clear csrattr rc est server init csrattr ectx null cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr cu assert strncmp test attr csr data csr len clear callback est set csr cb ectx null printf `` \\n unabl set est csr attribut callback abort \\n exit set smallest base size rc est server init csrattr ectx test attr strlen test attr cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr cu assert strncmp test attr csr data csr len rc est server init csrattr ectx test attr strlen test attr cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr cu assert strncmp test attr csr data csr len clear csrattr rc est server init csrattr ectx null cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len rc est server init csrattr ectx test_ nopop strlen test_ nopop cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test_ nopop cu assert strncmp test_ nopop csr data csr len enabl po p test respons po p ad st enabl pop rc est server init csrattr ectx test attr pop strlen test attr pop cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr data null cu assert csr len cu assert strncmp test attr pop csr data csr len rc est server init csrattr ectx test_ nopop strlen test_ nopop cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test_ pop cu assert strncmp test_ pop csr data csr len set size rc est server init csrattr ectx test attr_ strlen test attr_ cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len set size rc est server init csrattr ectx test attr_ strlen test attr_ cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len real base string need po p ad pass rc est server init csrattr ectx test attr nopop strlen test attr nopop cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr nopoppop cu assert strncmp test attr nopoppop csr data csr len real base string fail rc est server init csrattr ectx `` test cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len set smallest size rc est server init csrattr ectx test attr strlen test attr cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len set size rc est server init csrattr ectx test attr_ strlen test attr_ cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err set size rc est server init csrattr ectx test attr_ strlen test attr_ cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err set size rc est server init csrattr ectx test attr_ strlen test attr_ cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err set size rc est server init csrattr ectx test attr_ strlen test attr_ cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len est set csr cb ectx handl correct csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr cu assert strncmp test attr csr data csr len est set csr cb ectx handl nopop csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr nopoppop cu assert strncmp test attr nopoppop csr data csr len est set csr cb ectx handl csrattr request printf `` \\n unabl set est csr attribut callback abort \\n exit rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr pop cu assert strncmp test attr pop csr data csr len disabl po p st disabl pop clear callback est set csr cb ectx null printf `` \\n unabl set est csr attribut callback abort \\n exit real base string po p ad pass rc est server init csrattr ectx test attr nopop strlen test attr nopop cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr nopop cu assert strncmp test attr nopop csr data csr len asn type support cisco ssl rc est server init csrattr ectx test attr strlen test attr cu assert rc est err rc est client csrattr ctx csr data csr len cu assert rc est err cu assert csr len strlen test attr cu assert strncmp test attr csr data csr len ctx est destroy ctx cacert free cacert pkey free pkey main function set run test return cue success success run cunit error code failur add suit ifdef cunit cu p suit p suit null add suit registri p suit cu add suit `` proxi csrattr init suit destroy suit null p suit cu cleanup registri cu error add test suit null cu add test p suit `` csr proxi attribut api test cu cleanup registri cu error cue success endif